% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_negative_binomial.R
\name{fit_negative_binomial}
\alias{fit_negative_binomial}
\title{Negative Binomial Spline Regression}
\usage{
fit_negative_binomial(
  count_data,
  time_data,
  by_factor = NULL,
  cooks_constant = 4,
  return_plot = FALSE
)
}
\arguments{
\item{count_data}{Response vector of count data to be modeled}

\item{time_data}{Covariate of time data used in the model}

\item{by_factor}{(Optional) Additional categorical covariate}

\item{cooks_constant}{(Optional) Specify the sensitivity to outliers. Lower values give higher sensitivity.}

\item{return_plot}{(Optional) Boolean argument to return a ggplot2 plot object}
}
\value{
A list containing
\item{model}{mgcv::gam object. A spline model of count_data response variable and time_data covariate with by_factor as a possible factor}
\item{data}{Dataframe object. A data frame with binded count_data, time_data, by_factor (if used), and fitted value from model}
\item{cooks_distances}{Calculated cooks distances from model}
\item{outliers}{Flagged outliers based on cooks distances and cooks_constant}
\item{plot}{ggplot2 plot object of model fitted values}
}
\description{
Negative Binomial Spline Regression
}
\examples{

# Example dataset
data("jh_data_daily_confirm")

# Specify the count data to be the first 450 days of Illinois' daily Covid-19 cases
count_data = jh_data_daily_confirm$Illinois[1:450]

# Specify the time data to be the first 450 days
time_data = jh_data_daily_confirm$date[1:450]

# Add a "day of week" effect to the model
by_factor = jh_data_daily_confirm$day_of_week[1:450]


Illinois_negative_binomial = fit_negative_binomial(count_data, time_data,
                                                   by_factor, return_plot = TRUE)

}
